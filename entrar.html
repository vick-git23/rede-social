<!DOCTYPE html>
<html>
<head>
	<title>Folhagens</title>
	<link rel="icon" type="imge/gif" href="facebook.jpg" sizes="16x16">
	<link rel="stylesheet" type="text/css" href="reset.css"/>
	<link rel="stylesheet" type="text/css" href="entrar.css">
</head>

<body>
	<div class="linha"></div>
	<div class="titulo">
		<h1>Folhagens</h1>
		
		<button id="sair" onclick="sair()">Sair</button>
	</div>

	<div>
		<center>
			<button id="aba1" onclick="perfil()">Perfil</button>
			<button id="aba2" class="botaoVerde" onclick="conversas()">Conversas</button>
			<button id="aba3" class="botaoVerde" onclick="postagens()">Postagens</button>
		</center>
	</div>

	<abas>
		<div id="parteDoPerfil">
			<div>
				<div class="informacoes">
					<img src="../rede-social/pp.jpg" alt="Minha imagem" class="foto-perfil">
					<p id="amigos">Amigos</p>
					<p id="amizadeSolicitada">Solicitação de Amizade</p>
				</div>
			</div>

			<div class="meusPostsNoPerfil">
				<div id="publicacoesDoUsuarioLogado"></div>
			</div>
		</div>

		<div id="parteDaConversa" class="invisivel">
			<div class="meusAmigos">
				<h3>oi</h1>
			</div>

			<div class="caixaConversa">
				<div>
					<p contenteditable = "true" id="caixaMensagem" class="caixaMensagem"></p>
				</div>
			</div>
		</div>

		<div id="parteDasPostagens" class="invisivel">
			<div>
				<div class="sugestaoAmigos">
					<h2><center>Sugestão de Amigos</center></h2>
					<div id="usuarioAdicionado" class="osAmigos"></div>
				</div>
			</div>

			<div class="centro">
				<div class="escrever">
					<div class="texto">
						<label>Gostaria de compartilhar algo conosco hoje?</label>
					</div>
					<p contenteditable = "true" id="caixaTexto" class="caixaTexto"></p>
					<button class="botaoPostar" onclick="postar()">Postar</button>
				</div>
				<div id="publicacoesDeTodos"></div>
			</div>
		</div>	
	</abas>

	<script src="falsoBackend.js"></script>
	<script>
		function desaparece(){
			document.getElementById("parteDoPerfil").classList.add("invisivel");
			document.getElementById("parteDaConversa").classList.add("invisivel");
			document.getElementById("parteDasPostagens").classList.add("invisivel");
		}

		function apareceBotaoVerde(){
			document.getElementById("aba1").classList.add("botaoVerde");
			document.getElementById("aba2").classList.add("botaoVerde");
			document.getElementById("aba3").classList.add("botaoVerde");
		}

		function perfil() {
			desaparece()
			document.getElementById("parteDoPerfil").classList.remove("invisivel");

			apareceBotaoVerde()
			document.getElementById("aba1").classList.remove("botaoVerde");
			//document.getElementById("parteDoPerfil").classList.add("botaoBranco");

			let publicacoesDoUsuarioLogado = document.getElementById("publicacoesDoUsuarioLogado")
			publicacoesDoUsuarioLogado.innerHTML = ""

			postsDoUsuarioLogado()
		}

		function conversas() {
			desaparece()
			document.getElementById("parteDaConversa").classList.remove("invisivel");

			apareceBotaoVerde()
			document.getElementById("aba2").classList.remove("botaoVerde");
			//document.getElementById("parteDaConversa").classList.add("botaoBranco");
		}

		function postagens() {
			desaparece()
			document.getElementById("parteDasPostagens").classList.remove("invisivel");

			apareceBotaoVerde()
			document.getElementById("aba3").classList.remove("botaoVerde");			
			//document.getElementById("parteDasPostagens").classList.add("botaoBranco");
		}

		function postar() {
			let posts = document.getElementById("caixaTexto").innerHTML

			// verificar se caixaTexto1 e 2 nao é vazio
			if (posts === "") {
				// mostrar para o usuario que o nome de usuario esta vazio
				alert("Caixa de texto vazia")
				// parar de executar a funcao
				return;
			}

			let publicacoesDeTodos = document.getElementById("publicacoesDeTodos")

			// criar paragrafo que aparece nome do usuario
			let nomeUsuario = retornaUsuarioLogado();

			//publicacoes.appendChild(nomeUsuario);
			publicacoesDeTodos.innerHTML = `<div class="postagem"><p>${nomeUsuario}</p>${posts}</div>`+publicacoesDeTodos.innerHTML;
			console.log(publicacoesDeTodos)

			let meuPost ={
				nomeUsuario: nomeUsuario,
				postagem: posts
			}

			let todosOsPosts = retornaTodosOsPosts();
				if (!todosOsPosts) {
					todosOsPosts = []
				}

				todosOsPosts.push(meuPost);
				bancoPosts(todosOsPosts);
			}

		function  postsDoUsuarioLogado(){
			let publicacoesDoUsuarioLogado = document.getElementById("publicacoesDoUsuarioLogado")
			let todosOsPosts = retornaTodosOsPosts();
			let usuarioLogado = retornaUsuarioLogado();
			console.log(usuarioLogado)
			console.log(todosOsPosts)

			publicacoesDoUsuarioLogado.innerHTML = ""
			todosOsPosts.reverse();

			for (let i = 0; i < todosOsPosts.length; i ++) {
				if (usuarioLogado === todosOsPosts[i].nomeUsuario) {
					publicacoesDoUsuarioLogado.innerHTML+=`<div class="postagem"></p>${todosOsPosts[i].postagem}</div>`+publicacoesDeTodos.innerHTML;
				}
			}
			todosOsPosts.reverse()
		}

		function carregarSugestaoAmigos() {
			let container = document.getElementById("usuarioAdicionado")
            let usuariosAmigos = usuariosAtuais();

            for(let i=0; i<usuariosAmigos.length; i++){

                console.log("opa")
                //cria paragrafo que aparece nome do usuario
                let nomeUsuario = document.createElement("p");
                nomeUsuario.innerHTML = usuariosAmigos[i].nomeUsuario;

                let botaoAdicionar = document.createElement("button");
                botaoAdicionar.innerHTML = "Adicionar Amigo"
                botaoAdicionar.setAttribute("onclick",`usuarioAdicionado(${usuariosAmigos[i].id})`)

                container.appendChild(nomeUsuario);
                container.appendChild(botaoAdicionar);
            }
		}

		function usuarioAdicionado(idAmigo) {
			alert(`adicionando amigo com id ${idAmigo}`)
		}

		function sair() {
			window.location.href = "login.html"; 
		}

		perfil();
		carregarSugestaoAmigos();
	</script>
</body>
</html>